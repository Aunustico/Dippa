
\begin{figure}[htb]
\centering
\begin{tikzpicture}
% Place nodes using a matrix
	\matrix (m1) [row sep=2.5mm, column sep=5mm]
	{		%--------------------------------------------------------------------
		\node[dspnodeopen,dsp/label=above] (m00) {$x[n]$}; &
		\node[coordinate] (m01) {}; &
		\node[dspnodefull] (m02) {}; &
		\node[coordinate] (m03) {}; &
		\node[dspgainr] (m04) { $b_0$}; &
		\node[coordinate] (m05) {}; & 
		\node[dspadder]	(m06) {}; &
		\node[coordinate] (m07) {}; &
		\node[dspgainr] (m08) {$1$}; &
		\node[coordinate] (m09) {}; &
		\node[dspnodefull] (m010) {}; &
		\node[coordinate] (m011) {}; &
		\node[dspnodeopen,dsp/label=above] (m0X) {$y[n]$}; 
		\\
	%--------------------------------------------------------------------
		\node[coordinate] (m10) {}; &
		\node[coordinate] (m11) {}; &
		\node[dspsquare] (m12) {$\z^{-1}$}; &
		\node[coordinate] (m13) {}; &
		\node[coordinate] (m14) {}; &
		\node[coordinate] (m15) {}; &
		\node[coordinate] (m16) {}; &
		\node[coordinate] (m17) {}; &
		\node[coordinate] (m18) {}; &
		\node[coordinate] (m19) {}; &
		\node[dspsquare] (m110) {$\z^{-1}$}; &
		\node[coordinate] (m111) {}; &
		\node[coordinate] (m1X) {};         
		\\
	%--------------------------------------------------------------------
		\node[coordinate] (m20) {}; &
		\node[coordinate] (m21) {}; &
		\node[dspnodefull] (m22) {}; &
		\node[coordinate] (m23) {} ; &
		\node[dspgainr] (m24) {$b_1$};          &
		\node[coordinate](m25) {}; &
		\node[dspadder] (m26) {}; &
		\node[coordinate] (m27) {}; &
		\node[dspgainl] (m28) {$-a_1$}; &
		\node[coordinate] (m29) {}; &
		\node[dspnodefull] (m210) {}; &
		\node[coordinate] (m211) {}; &
		\node[coordinate] (m2X) {};         
		\\
	%--------------------------------------------------------------------
		\node[coordinate] (m30) {}; &
		\node[coordinate] (m31) {}; &
		\node[dspsquare] (m32) {$\z^{-1}$}; &
		\node[coordinate] (m33) {} ; &
		\node[coordinate] (m34) {};          &
		\node[coordinate](m35) {}; &
		\node[coordinate] (m36) {}; &
		\node[coordinate] (m37) {}; &
		\node[coordinate] (m38) {}; &
		\node[coordinate] (m39) {}; &
		\node[dspsquare] (m310) {$\z^{-1}$}; &
		\node[coordinate] (m311) {}; &
		\node[coordinate] (m3X) {};         
		\\
	%--------------------------------------------------------------------
		\node[coordinate] (m40) {}; &
		\node[coordinate] (m41) {}; &
		\node[dspnodefull] (m42) {}; &
		\node[coordinate] (m43) {}; &
		\node[dspgainr] (m44) {$b_2$}; &
		\node[coordinate] (m45) {}; &
		\node[dspadder] (m46) {}; &
		\node[coordinate] (m47) {}; &
		\node[dspgainl] (m48) {$-a_2$}; &
		\node[coordinate] (m49) {}; &
		\node[dspnodefull] (m410) {}; &
		\node[coordinate] (m411) {}; &
		\node[coordinate] (m4X) {};
		\\
		\\
		\\
		%--------------------------------------------------------------------
		\node[coordinate] (m50) {}; &
		\node[coordinate] (m51) {}; &
		\node[dspsquare] (m52) {$\z^{-1}$}; &
		\node[coordinate] (m53) {} ; &
		\node[coordinate] (m54) {};          &
		\node[coordinate](m55) {}; &
		\node[coordinate] (m56) {}; &
		\node[coordinate] (m57) {}; &
		\node[coordinate] (m58) {}; &
		\node[coordinate] (m59) {}; &
		\node[dspsquare] (m510) {$\z^{-1}$}; &
		\node[coordinate] (m511) {}; &
		\node[coordinate] (m5X) {};         
		\\
	%--------------------------------------------------------------------
		\node[coordinate] (m60) {}; &
		\node[coordinate] (m61) {}; &
		\node[coordinate] (m62) {}; &
		\node[coordinate] (m63) {}; &
		\node[dspgainr] (m64) {$b_n$}; &
		\node[coordinate] (m65) {}; &
		\node[dspadder] (m66) {}; &
		\node[coordinate] (m67) {}; &
		\node[dspgainl] (m68) {$-a_n$}; &
		\node[coordinate] (m69) {}; &
		\node[coordinate] (m610) {}; &
		\node[coordinate] (m611) {}; &
		\node[coordinate] (m6X) {};
		\\
		%--------------------------------------------------------------------
	};
		
	\draw[dspflow] (m00) -- (m02);
	\draw[dspconn] (m02) -- (m04);
	\draw[dspconn] (m04) -- (m06);
	\draw[dspflow] (m010) -- (m0X);	
	\draw[dspconn] (m06) -- (m08);
	\draw[dspflow] (m08) -- (m010);
	
	\draw[dspconn] (m02) -- (m12);
	\draw[dspline] (m12) -- (m22);
	\draw[dspconn] (m22) -- (m32);
	\draw[dspline] (m32) -- (m42);	
	\draw[dspconn] (m26) -- (m06);
	\draw[dspconn] (m46) -- (m26);	
	\draw[dspconn] (m22) -- (m24);
	\draw[dspconn] (m24) -- (m26);	
	\draw[dspconn] (m42) -- (m44);
	\draw[dspconn] (m44) -- (m46);	
	\draw[dspconn, dashed] (m42) -- (m52);
	\draw[dspline] (m52) -- (m62);
	\draw[dspconn] (m62) -- (m64);
	\draw[dspconn] (m64) -- (m66);
	\draw[dspline] (m66) -- (m56);
	\draw[dspconn, dashed] (m56) -- (m46);
	
	\draw[dspconn] (m010) -- (m110);
	\draw[dspconn] (m68) -- (m66);
	\draw[dspconn] (m48) -- (m46);
	\draw[dspconn] (m28) -- (m26);
	\draw[dspconn] (m210) -- (m28);
	\draw[dspconn] (m410) -- (m48);
	\draw[dspconn] (m610) -- (m68);
	\draw[dspline] (m110) -- (m210);
	\draw[dspconn] (m210) -- (m310);
	\draw[dspline] (m310) -- (m410);
	\draw[dspconn, dashed] (m410) -- (m510);
	\draw[dspline] (m510) -- (m610);
\end{tikzpicture}
\caption{An example of an $n$-th order IIR filter in direct form I} \label{iirfilterdiagram}
\end{figure}